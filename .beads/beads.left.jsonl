{"id":"BT-0su","content_hash":"b5e18e9f562aed204250982f36afd2f193362f5d17d303755a251d49174292ee","title":"Тест 3: Пошук ДБН В.2.5-39:2008 (теплові мережі)","description":"","design":"Критичний для теплових мереж Том 2","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-13T21:00:48.221037+02:00","updated_at":"2025-11-13T21:00:48.221037+02:00","source_repo":"."}
{"id":"BT-0va","content_hash":"89464f060e0e05af46210a0ac155c7e01b00193c15973e8251bc27f73781a3fd","title":"Реалізувати HTML scraping для документів без PDF","description":"Для старих документів (2009-2013) які не мають PDF версії, скрапити HTML контент.\n\nПРОБЛЕМА:\n- document.html?id_doc=X для старих docs показує HTML, не PDF iframe\n- Приклад: ДСТУ-Н Б В.1.2-16:2013 (id_doc=52387) - немає iframe\n\nРІШЕННЯ:\nАлгоритм прийняття рішення в downloadPdf():\n1. Спробувати знайти iframe з PDF URL\n2. Якщо немає iframe → fallback to HTML scraping\n3. Скрапити HTML контент з document.html\n4. Опції збереження:\n   - HTML як є (для архіву)\n   - Конвертувати HTML → MD (для git/читабельності)\n   - Використати puppeteer page.pdf() на HTML версію (emergency)\n\nТЕХНОЛОГІЯ:\n- puppeteer evaluate() → витягти основний контент\n- cheerio для парсингу структури (заголовки, таблиці, списки)\n- Можливо turndown (html-to-markdown) якщо потрібен MD\n\nДОКУМЕНТИ ДЛЯ ТЕСТУВАННЯ:\n- ДСТУ-Н Б В.1.2-16:2013 (id=52387)\n- ДСТУ Б А.2.4-6:2009 (id=25337)\n- ДБН В.2.5-23:2010 (id=25886)\n\nACCEPTANCE:\n- downloadPdf() автоматично визначає: PDF чи HTML\n- Якщо HTML → скрапить контент\n- Зберігає з читабельною назвою\n- Формат: TBD (HTML/MD/hybrid)","notes":"HTML scraping реалізовано і протестовано:\n\n✅ Створено функцію scrapeHtmlContent():\n- Витягує контент з #bsdoctext\n- Створює standalone HTML з стилями\n- Зберігає з людяною назвою\n- Повертає format: 'html'\n\n✅ Оновлено downloadPdf():\n- Автоматичний fallback: PDF → HTML\n- Якщо немає iframe → викликає scrapeHtmlContent()\n- Працює прозоро для користувача\n\n✅ Протестовано на 3 документах:\n1. ДСТУ-Н Б В.1.2-16:2013 (115KB HTML)\n2. ДСТУ Б А.2.4-6:2009 (57KB HTML) \n3. ДБН В.2.5-23:2010 (549KB HTML)\n\nВсі HTML файли переміщені в KRTM standards/","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-13T22:14:35.284088+02:00","updated_at":"2025-11-13T22:19:37.385287+02:00","closed_at":"2025-11-13T22:19:37.38529+02:00","source_repo":"."}
{"id":"BT-1d8","content_hash":"8b7afe2882b51b67a0a0f97d832aaf8f2e08d1cd994d6bb65f62295f640c58a0","title":"План для KRTM: Завантаження 11 критичних документів","description":"","design":"CRITICAL (3 docs): ДСТУ-Н Б В.1.2-16:2013, ДБН В.2.5-20:2018, ДБН В.2.5-39:2008. HIGH (3 docs): ДСТУ Б А.2.4-4:2009, ДСТУ Б А.2.4-6:2009, ДБН В.2.5-23:2010. MEDIUM/LOW (5 docs)","acceptance_criteria":"Всі документи завантажені в /Users/sd/github/krtm/pkd/00-metadata/standards/ та upload до Gemini store 'krtm-regulations'","status":"open","priority":1,"issue_type":"epic","created_at":"2025-11-13T21:10:30.089112+02:00","updated_at":"2025-11-13T21:10:30.089112+02:00","source_repo":"."}
{"id":"BT-1q0","content_hash":"fc618ad4c55a53a15c7c6e09857c0426709c4d4b27fabb928cb4c78aa001349a","title":"Тест 7: Semantic search в Gemini","description":"","design":"Перевірка пошуку по завантаженому документу","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-13T21:01:00.779859+02:00","updated_at":"2025-11-13T21:10:06.258571+02:00","closed_at":"2025-11-13T21:10:06.258571+02:00","source_repo":"."}
{"id":"BT-3em","content_hash":"b8099f20baf49d0021b7abc3ba2b8a715ad3dc83c11b45c0ecfa0f0369216b08","title":"Research: PDF vs MD для Gemini File API + conversion pipelines","description":"Дослідити оптимальний формат для Gemini File API і способи конверсії:\n\nФАЗА 1: Дослідження Gemini API File Service\n- Документація: які формати підтримує, які рекомендує\n- Як Gemini парсить PDF (структура, таблиці, зображення)\n- Як Gemini обробляє Markdown (чистий текст, таблиці)\n- Порівняти якість semantic search: один документ як PDF vs як MD\n- Виміряти швидкість обробки та індексації\n- Вивчити best practices для technical documentation\n\nФАЗА 2: Тестування conversion pipelines (якщо MD виявиться кращим)\n- Спосіб A: pdf2docx → pandoc (DOCX проміжний формат)\n  * pdf2docx: pip install pdf2docx\n  * pandoc output.docx -o output.md --extract-media=./media\n- Спосіб B: marker-pdf (AI-powered, найкраща якість)\n  * pip install marker-pdf  \n  * marker_single input.pdf output.md\n- Спосіб C: pypdf + custom parser\n- Порівняти якість на ДСТУ 4163:2020:\n  * Таблиці (збереження структури)\n  * Зображення/діаграми (extraction чи опис)\n  * Спецсимволи, формули\n  * Багатоколонкові макети\n\nРІШЕННЯ:\n- Якщо PDF === MD для Gemini → залишити PDF (простіше)\n- Якщо MD краще → вибрати найкращий conversion tool\n- Dual storage: pdf/ (оригінали) + md/ (для git/grep) якщо потрібно\n\nВАЖЛИВО: Pandoc НЕ читає PDF! (\"Pandoc can convert to PDF, but not from PDF\")\nПотрібен окремий tool для PDF → DOCX/MD.","notes":"ФАЗА 1 ЗАВЕРШЕНА (BT-9x1):\n✓ Прочитано Gemini File Search API docs\n✓ Висновок: PDF === MD (обидва → embeddings, no preference documented)\n✓ Звіт: budstandart/GEMINI_FILE_SEARCH_RESEARCH.md\n\nРІШЕННЯ на основі docs:\n- Default strategy: PDF (простіше, оригінали)\n- Experimental: MD тільки якщо практичне тестування покаже переваги\n\nФАЗА 2 (conversion pipelines):\n- Залишається як LOW PRIORITY\n- Робити тільки якщо:\n  1. Практичний тест PDF показує проблеми з таблицями\n  2. MD тест показує кращу якість search\n  3. Є реальна потреба в git-friendly format\n\nНаразі: продовжуємо з PDF, conversion - майбутня оптимізація.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-13T21:37:04.497807+02:00","updated_at":"2025-11-13T21:46:21.729531+02:00","source_repo":"."}
{"id":"BT-3rv","content_hash":"5de45e31f8e616b768db0964e95416f94b3815441bec1b334a2950bcc9178b33","title":"Оновити SETUP.md: видалити print, додати download","description":"Оновити документацію після заміни printToPdf на downloadPdf:\n- Видалити згадки про команду 'print'\n- Додати опис команди 'download'\n- Оновити приклади використання\n- Підкреслити що download дає чистий PDF (не screenshot екрану)","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-13T21:36:45.374905+02:00","updated_at":"2025-11-13T21:36:45.374905+02:00","source_repo":"."}
{"id":"BT-6gz","content_hash":"8a61982e50367e954467a45979553617a2ca43820fe877ccfb01c9dfc90402d4","title":"Тест 1: Пошук ДСТУ-Н Б В.1.2-16:2013","description":"","design":"Критичний документ для Том 1-2. Потрібен для обґрунтування CC1 та категорії складності III","notes":"Пошук повертає порожній масив. Cheerio селектори потребують debug. URL правильний: /ua/catalog/searchdoc.html","status":"blocked","priority":1,"issue_type":"task","created_at":"2025-11-13T21:00:44.945115+02:00","updated_at":"2025-11-13T21:08:51.047651+02:00","source_repo":"."}
{"id":"BT-74w","content_hash":"c95858f363f97c98980675844d78a80e28d840672395291f11f8014d62e76a0c","title":"Завантажити всі 11 критичних документів для KRTM","description":"Використовуючи команду 'download', завантажити всі 11 документів для Том 1-4:\n\nТОМ 1: Загальні положення (P1)\n1. ДСТУ 4163:2020 - Вимоги до оформлення документів ✓ (вже завантажений)\n2. ДБН А.2.2-3:2014 - Склад та зміст проектної документації\n3. ДСТУ-Н Б А.3.1-11:2013 - Енергозбереження в будівництві\n\nТОМ 2: Конструктивні та технічні рішення (P1)\n4. ДБН В.2.2-15:2019 - Житлові будинки: основні положення\n5. ДБН В.2.6-31:2021 - Теплова ізоляція будівель\n\nТОМ 3: Інженерні мережі (P1)\n6. ДБН В.2.5-20:2018 - Газопостачання\n7. ДБН В.2.5-39:2008 - Теплові мережі\n8. ДБН В.2.5-74:2013 - Водопостачання: зовнішні мережі\n\nТОМ 4: Техніко-економічні показники (P2)\n9. ДБН А.2.2-12:2019 - Кошторисна документація\n10. ДСТУ Б Д.1.1-1:2013 - Ресурсні кошториси\n11. ДБН Б.2.4-7:2019 - Планування територій\n\nКоманда для кожного:\n./browser-budstandart.js download \u003cid_doc\u003e\n\nСтворити окремі sub-tasks для кожного тому.","notes":"Завантажено 8 документів для KRTM (з 11 запланованих):\n\n✅ PDF (5):\n1. ДБН В.2.5-20:2018 - Газопостачання (1.8MB)\n2. ДБН В.2.5-39:2008 - Теплові мережі (1.8MB)\n3. ДБН В.2.5-56:2014 - Протипожежний захист (1.2MB)\n4. ДБН В.2.5-74:2013 - Водопостачання (2.7MB)\n5. ДСТУ 4163:2020 - Оформлення документів (427KB)\n\n✅ HTML (3):\n1. ДСТУ-Н Б В.1.2-16:2013 - Клас наслідків (115KB)\n2. ДСТУ Б А.2.4-6:2009 - Генплани (57KB)\n3. ДБН В.2.5-23:2010 - Електрообладнання (549KB)\n\n❌ Не знайдено (3):\n1. ДСТУ Б А.2.4-4:2009 - Специфікації (пошук не дав результатів)\n2. ДБН В.1.2-14:2018 - Надійність (Target closed error)\n3. ДСТУ IEC 60870-5-104 - Ukrainian version (не існує?)\n\nРезультат: 8/11 (72%) - успішно завантажено з автоматичним fallback PDF→HTML","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-13T21:37:21.49142+02:00","updated_at":"2025-11-13T22:19:39.213447+02:00","closed_at":"2025-11-13T22:19:39.21345+02:00","source_repo":".","dependencies":[{"issue_id":"BT-74w","depends_on_id":"BT-1d8","type":"blocks","created_at":"2025-11-13T21:37:21.492659+02:00","created_by":"daemon"}]}
{"id":"BT-8hg","content_hash":"44e4e5a7729a181d54a2959d7b52ed7428fd209e1252116f4a4c7581b80ddb93","title":"Тест 6: Upload PDF до Gemini","description":"","design":"Завантаження тестового документа","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-13T21:01:00.70514+02:00","updated_at":"2025-11-13T21:09:45.022185+02:00","closed_at":"2025-11-13T21:09:45.022185+02:00","source_repo":"."}
{"id":"BT-9x1","content_hash":"a798a87a136b115af2533e4a4f193a10c960687d07163622638ab2e3c8e5d506","title":"DONE: Дослідження Gemini File Search API документації","description":"Прочитано офіційну документацію Gemini File Search API:\n- https://ai.google.dev/gemini-api/docs/file-search\n- https://ai.google.dev/api/file-search/file-search-stores  \n- https://ai.google.dev/api/file-search/documents\n- https://ai.google.dev/api/all-methods\n\nЗвіт зі висновками створено окремим документом.","notes":"Звіт створено: budstandart/GEMINI_FILE_SEARCH_RESEARCH.md\n\nКЛЮЧОВІ ВИСНОВКИ:\n1. PDF === MD для Gemini (обидва → embeddings)\n2. Документація НЕ дає переваг одному форматові\n3. Різниця може бути в chunking/table parsing\n4. Потребує практичного тестування\n\nРЕКОМЕНДАЦІЯ:\n- Для KRTM: використати PDF (простіше, source of truth)\n- Додати metadata для фільтрації (type, year, tom, priority)\n- Experimental: протестувати MD на 1-2 документах\n\nОбмеження:\n- Max file: 100MB\n- Free tier: 1GB storage\n- Pricing: $0.15/1M tokens indexing (одноразово)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-13T21:45:12.071496+02:00","updated_at":"2025-11-13T21:46:07.340514+02:00","closed_at":"2025-11-13T21:46:07.340516+02:00","source_repo":"."}
{"id":"BT-a7k","content_hash":"75040f211b5bfcc5b736906ed941221ef87a70f5bcc5b6d68209f9bec3aa1223","title":"Тест 5: Створити Gemini store 'krtm-test'","description":"","design":"Перевірка створення File Search store","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-13T21:01:00.631447+02:00","updated_at":"2025-11-13T21:09:28.501883+02:00","closed_at":"2025-11-13T21:09:28.501883+02:00","source_repo":"."}
{"id":"BT-ere","content_hash":"c6275e03e7c8250bf0423441f53971eefbac266c5fcc4b2cf7423358f5a9b71f","title":"Протестувати downloadPdf на різних типах документів","description":"Перевірити що новий downloadPdf працює коректно з різними типами документів:\n\n1. ДСТУ (стандарти) - текстові документи ✓\n2. ДБН (будівельні норми) - з таблицями, схемами\n3. Документи з діаграмами/кресленнями\n4. Багатосторінкові документи (100+ сторінок)\n5. Документи з нестандартними символами\n\nПеревірити:\n- Чи завантажується повний PDF (не обрізаний)\n- Чи правильно формується назва файлу\n- Чи PDF відкривається без помилок\n- Розмір файлу адекватний\n- Порівняти з оригіналом на сайті (візуально)\n\nПротестувати хоча б 3-5 різних документів перед масовим завантаженням.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-13T21:37:37.70833+02:00","updated_at":"2025-11-13T21:37:37.70833+02:00","source_repo":"."}
{"id":"BT-syt","content_hash":"c4f783d03bfb890c7e088a47897d8207fcf680d19991ac02b938e6a681d8640e","title":"Тест 2: Пошук ДБН В.2.5-20:2018 (газопостачання)","description":"","design":"Критичний для котелень Том 2","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-13T21:00:46.662322+02:00","updated_at":"2025-11-13T21:00:46.662322+02:00","source_repo":"."}
{"id":"BT-tgf","content_hash":"0848b5e97201fcefefecaab2a09d14fb10856cb69866a46bf9481a50310f1932","title":"ISSUE: Функція search повертає порожній масив","description":"","design":"Cheerio селектори не парсять HTML результатів пошуку. URL правильний (/ua/catalog/searchdoc.html), але парсинг не працює. Потребує debug селекторів.","acceptance_criteria":"Search має повертати масив документів з id_doc, title, url","notes":"Search функцію виправлено:\n- Змінено selector з 'a[href*=\"doc-page\"]' на 'a[href*=\"id_doc\"]'\n- Додано фільтр: title.length \u003e 10 \u0026\u0026 no duplicates\n- Працює з document.html URL (не doc-page.html)\n- Протестовано: ДСТУ-Н, ДБН, ДСТУ документи","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-13T21:10:28.244635+02:00","updated_at":"2025-11-13T22:13:11.563313+02:00","closed_at":"2025-11-13T22:13:11.563316+02:00","source_repo":"."}
{"id":"BT-vbp","content_hash":"70d670cdf56ad2c08e0e1e2c288d54140b839c021417982e5ea8d3a2b09fa8aa","title":"Тест 4: Print to PDF знайденого документа","description":"","design":"Перевірка функції збереження PDF локально","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-13T21:01:00.558353+02:00","updated_at":"2025-11-13T21:09:10.509936+02:00","closed_at":"2025-11-13T21:09:10.509936+02:00","source_repo":"."}
